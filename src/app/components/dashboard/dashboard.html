<!-- src/app/components/dashboard/dashboard.html -->
<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="welcome-section">
        <h1>Welcome, {{ currentUser?.name || 'User' }}!</h1>
        <p>Royal Associates Group Dashboard</p>
      </div>
      <div class="header-actions">
        <button class="btn btn-logout" (click)="logout()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
            <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Logout
        </button>
      </div>
    </div>
  </header>

  <main class="dashboard-content">
    <!-- Stats Grid -->
    <section class="stats-section">
      <div class="stat-card stat-primary">
        <div class="stat-icon-wrapper">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
            <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2M9 11a4 4 0 100-8 4 4 0 000 8zM23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3>{{ totalEmployees }}</h3>
          <p>Total Employees</p>
        </div>
      </div>

      <div class="stat-card stat-success">
        <div class="stat-icon-wrapper">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8zM14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3>{{ recentRegistrations }}</h3>
          <p>This Month</p>
        </div>
      </div>

      <div class="stat-card stat-info">
        <div class="stat-icon-wrapper">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
            <path d="M22 11.08V12a10 10 0 11-5.93-9.14M22 4L12 14.01l-3-3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="stat-content">
          <h3>{{ completedProfiles }}</h3>
          <p>Complete Profiles</p>
        </div>
      </div>
    </section>

    <!-- Quick Actions -->
    <section class="actions-section">
      <h2 class="section-title">Quick Actions</h2>
      <div class="actions-grid">
        <button class="action-card action-primary" routerLink="/onboarding">
          <div class="action-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <line x1="12" y1="8" x2="12" y2="16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <line x1="8" y1="12" x2="16" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <h3>Add New Employee</h3>
          <p>Register a new employee with complete onboarding</p>
        </button>

        <button class="action-card action-secondary" (click)="refreshData()">
          <div class="action-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none">
              <path d="M1 4v6h6M23 20v-6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <h3>Refresh Data</h3>
          <p>Update employee records and statistics</p>
        </button>
      </div>
    </section>

    <!-- Employees Table -->
    <section class="table-section">
      <div class="table-header">
        <h2 class="section-title">Recent Employees</h2>
        <div class="table-controls">
          <div class="search-box">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
              <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <input type="text" placeholder="Search employees..." [(ngModel)]="searchTerm" (input)="filterEmployees()">
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div class="loading-state" *ngIf="loading">
        <div class="spinner"></div>
        <p>Loading employee data...</p>
      </div>

      <!-- Empty State -->
      <div class="empty-state" *ngIf="!loading && employees.length === 0">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none">
          <path d="M9 11l3 3L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <h3>No Employees Found</h3>
        <p>Start by adding your first employee to the system</p>
        <button class="btn btn-primary" routerLink="/onboarding">Add First Employee</button>
      </div>

      <!-- Table -->
      <div class="table-wrapper" *ngIf="!loading && employees.length > 0">
        <table class="employees-table">
          <thead>
            <tr>
              <th>S.No</th>
              <th>Name</th>
              <th>Email</th>
              <th>Mobile</th>
              <th>Registration Date</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let employee of filteredEmployees; let i = index" class="table-row">
              <td>
                <span class="serial-badge">{{ employee.slNo }}</span>
              </td>
              <td>
                <div class="employee-info">
                  <div class="avatar">{{ getInitials(employee.name) }}</div>
                  <span class="employee-name">{{ employee.name }}</span>
                </div>
              </td>
              <td>
                <span class="text-muted">{{ employee.emailId }}</span>
              </td>
              <td>
                <span class="text-muted">{{ employee.mobileNumber }}</span>
              </td>
              <td>
                <span class="text-muted">{{ formatDate(employee.createdAt) }}</span>
              </td>
              <td>
                <span class="status-badge" [ngClass]="getStatusClass(employee)">
                  <span class="status-dot"></span>
                  {{ getStatusText(employee) }}
                </span>
              </td>
              <td>
                <button class="btn-action" (click)="viewEmployeeDetails(employee)">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                  </svg>
                  View
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- Employee Detail Modal -->
  <div class="modal-overlay" *ngIf="selectedEmployee" (click)="closeEmployeeDetails()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Employee Details</h2>
        <button class="btn-close" (click)="closeEmployeeDetails()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <line x1="18" y1="6" x2="6" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="6" y1="6" x2="18" y2="18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <div class="modal-body">
        <!-- Basic Info -->
        <div class="detail-section">
          <h3 class="detail-title">Basic Information</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <label>Full Name</label>
              <p>{{ selectedEmployee.name }}</p>
            </div>
            <div class="detail-item">
              <label>Serial Number</label>
              <p>{{ selectedEmployee.slNo }}</p>
            </div>
            <div class="detail-item">
              <label>Email</label>
              <p>{{ selectedEmployee.emailId }}</p>
            </div>
            <div class="detail-item">
              <label>Mobile</label>
              <p>{{ selectedEmployee.mobileNumber }}</p>
            </div>
            <div class="detail-item detail-full">
              <label>Address</label>
              <p>{{ selectedEmployee.address }}</p>
            </div>
            <div class="detail-item">
              <label>Registration Date</label>
              <p>{{ formatDate(selectedEmployee.createdAt) }}</p>
            </div>
          </div>
        </div>

        <!-- Biometric Info -->
        <div class="detail-section">
          <h3 class="detail-title">Biometric Information</h3>
          <div class="biometric-grid">
            <div class="biometric-card">
              <label>Photo</label>
              <div class="biometric-preview">
                <img *ngIf="hasValidPhoto(selectedEmployee)" [src]="selectedEmployee.photo" alt="Photo" class="bio-image">
                <div *ngIf="!hasValidPhoto(selectedEmployee)" class="bio-empty">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                    <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                    <circle cx="8.5" cy="8.5" r="1.5" fill="currentColor"/>
                    <path d="M21 15l-5-5L5 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <p>No photo</p>
                </div>
              </div>
            </div>

            <div class="biometric-card">
              <label>Signature</label>
              <div class="biometric-preview">
                <img *ngIf="hasValidSignature(selectedEmployee)" [src]="selectedEmployee.signature" alt="Signature" class="bio-image">
                <div *ngIf="!hasValidSignature(selectedEmployee)" class="bio-empty">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                    <path d="M17 3a2.828 2.828 0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                  <p>No signature</p>
                </div>
              </div>
            </div>

            <div class="biometric-card">
              <label>Fingerprint</label>
              <div class="biometric-preview">
                <div *ngIf="hasValidFingerprint(selectedEmployee)" class="bio-captured">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                    <path d="M12 10a2 2 0 100-4 2 2 0 000 4zM12 10v11M8 14c0-2.21 1.79-4 4-4s4 1.79 4 4M6 18c0-3.31 2.69-6 6-6s6 2.69 6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                  <p class="captured-text">Captured</p>
                </div>
                <div *ngIf="!hasValidFingerprint(selectedEmployee)" class="bio-empty">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <line x1="12" y1="8" x2="12" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <line x1="12" y1="16" x2="12.01" y2="16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                  <p>No fingerprint</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeEmployeeDetails()">Close</button>
      </div>
    </div>
  </div>
</div>